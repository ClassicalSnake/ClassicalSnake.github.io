function refreshScore(a){document.getElementById("score").innerHTML=a}function random(a,b){return Math.floor(Math.random()*b+a)}function getPixelWidth(){return GRID_WIDTH*UNIT_SIZE}function getPixelHeight(){return GRID_HEIGHT*UNIT_SIZE}function move(a,b,c){"UP"===b?(a.y-=UNIT_SIZE,a.y<c.up&&(a.y=c.down-UNIT_SIZE)):"DOWN"===b?(a.y+=UNIT_SIZE,a.y>=c.down&&(a.y=c.up)):"LEFT"===b?(a.x-=UNIT_SIZE,a.x<c.left&&(a.x=c.right-UNIT_SIZE)):"RIGHT"===b&&(a.x+=UNIT_SIZE,a.x>=c.right&&(a.x=c.left))}function init(){function a(){n.load.script("webfont","//ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js")}function b(){if(v){for(var a=o.length-1;a>0;a--)o[a].x=o[a-1].x,o[a].y=o[a-1].y;move(o[0],w.pull(),{up:0,down:n.height,left:0,right:n.width})}}function c(){for(var a=o[0],b=1;b<o.length;b++)if(o[b].x===a.x&&o[b].y===a.y)return!0;return!1}function d(){r.visible=!1}function e(){null===r?(r=n.add.text(getPixelWidth()/2,120,"YOU LOST\nPRESS ENTER",{font:"Geo",fontSize:50,align:"center",fill:"#ff0000"}),r.anchor.setTo("0.5")):r.visible=!0}function f(a,b){for(var c=null,d=0;d<o.length;d++)if(o[d].x===a&&o[d].y===b){c=o[d];break}return null!==c}function g(){for(var a=q.xs[random(0,q.xs.length)],b=q.ys[random(0,q.ys.length)];f(a,b);)a=q.xs[random(0,q.xs.length)],b=q.ys[random(0,q.ys.length)];p.x=a+FOOD_SIZE/2,p.y=b+FOOD_SIZE/2}function h(){var a=o[o.length-1];o.push(new Phaser.Rectangle(a.x,a.y,UNIT_SIZE,UNIT_SIZE))}function i(){return o[0].x===p.x-FOOD_SIZE/2&&o[0].y===p.y-FOOD_SIZE/2}function j(){o=[];for(var a=0,b=INITIAL_X;a<SNAKE_SIZE;a++,b-=UNIT_SIZE)o.push(new Phaser.Rectangle(b,INITIAL_Y,UNIT_SIZE,UNIT_SIZE));g()}function k(){for(var a=0;a<n.width;a+=UNIT_SIZE)q.xs.push(a);for(var c=0;c<n.height;c+=UNIT_SIZE)q.ys.push(c);j(),n.time.events.loop(DELAY,b,this),n.stage.backgroundColor="#6A787D",t=n.input.keyboard.addKey(Phaser.Keyboard.ENTER)}function l(){null===s&&(s=n.input.keyboard.createCursorKeys()),s.down.isDown&&"UP"!==w.current()&&x?(w.push("DOWN"),x=!1,y=s.down):s.up.isDown&&"DOWN"!==w.current()&&x?(w.push("UP"),x=!1,y=s.up):s.right.isDown&&"LEFT"!==w.current()&&x?(w.push("RIGHT"),x=!1,y=s.right):s.left.isDown&&"RIGHT"!==w.current()&&x?(w.push("LEFT"),x=!1,y=s.left):!v&&t.isDown&&x?(x=!1,y=t,d(),j(),w.reset(),u=0,refreshScore(u),v=!0):null!==y&&y.isUp&&(x=!0),i()&&(g(),u+=5,h(),refreshScore(u)),c()&&v&&(v=!1,e())}function m(){if(v){n.debug.geom(p,"#ffffff");for(var a=1;a<o.length;a++)n.debug.geom(o[a],"#ffffff");n.debug.geom(o[0],"#ffffff")}}var n=new Phaser.Game(getPixelWidth(),getPixelHeight(),Phaser.AUTO,"main-container",{preload:a,create:k,update:l,render:m}),o=[],p=new Phaser.Rectangle(-20,-20,FOOD_SIZE,FOOD_SIZE),q=(new Phaser.Rectangle(0,0,n.width,n.height),{xs:[],ys:[]}),r=null,s=null,t=null,u=0,v=!0;WebFontConfig={active:function(){},google:{families:["Geo"]}};var w={_queue:[],_currentDirection:"RIGHT",pull:function(){return this._queue.length>0?(this._currentDirection=this._queue.shift(),this._currentDirection):this._currentDirection},push:function(a){this._queue.push(a)},current:function(){return this._currentDirection},reset:function(){this._queue=[],this._currentDirection="RIGHT"}},x=!0,y=null}function sendFeedback(a,b){var c=new XMLHttpRequest;c.open("POST","https://classicalbackend-chedymissaoui.rhcloud.com/feedbacks"),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.onload=function(){},c.send("name="+encodeURI(a)+"&feedback="+encodeURI(b))}function sendDemand(a,b){var c=new XMLHttpRequest;c.open("POST","https://classicalbackend-chedymissaoui.rhcloud.com/demands"),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.onload=function(){},c.send("email="+encodeURI(a)+"&osType="+encodeURI(b))}function demand(){var a=document.getElementById("demand-form").style.display;if("none"===a)document.getElementById("demand-form").style.display="block";else{var b=document.getElementById("ostype");sendDemand(document.getElementById("email").value,b.options[b.selectedIndex].value),document.getElementById("demand-form").style.display="none",document.getElementById("email").value="",alert("Thanks!")}}function hideModal(){document.getElementById("dark").style.display="none",document.getElementById("modal").style.display="none"}function submitFeedBack(){return hideModal(),sendFeedback(document.getElementById("name").value,document.getElementById("feedback-content").value),document.getElementById("name").value="",document.getElementById("feedback-content").value="",alert("Thanks!"),!1}function showModal(){document.getElementById("modal").style.display="block",document.getElementById("dark").style.display="block"}var UNIT_SIZE=20,FOOD_SIZE=UNIT_SIZE/2,INITIAL_X=100,INITIAL_Y=UNIT_SIZE,SNAKE_SIZE=4,DELAY=75,GRID_WIDTH=34,GRID_HEIGHT=20;